<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Vibhor Kanojia">
    <meta name="description" content="Vibhor&#39;s personal space">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Morris Traversal"/>
<meta name="twitter:description" content="As discussed before, there are various ways to traverse a binary tree. Inorder traversal is very popular as it visits nodes in a sorted manner if the tree is a binary search tree.
The common implementation of inorder traversal is by recursion. But recursive implementation is not considered to be O(1) space solution due to the recursion stack; it is in fact O(logN). Inorder traversal can also be implemented iteratively by using a stack data structure, but even this implementation will have O(N) space complexity. There exists an algorithm called Morris Traversal which guarantees iterative inorder traversal of a binary tree with O(1) space complexity. 
 Note that this is a slightly advanced algorithm and should be considered only when the normal recursive implementation results in TLE."/>


    <base href="http://vibhorkanojia.github.io/algorithms/mt/">
    <title>
  Morris Traversal · vibhor kanojia
</title>

    <link rel="canonical" href="http://vibhorkanojia.github.io/algorithms/mt/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://vibhorkanojia.github.io/css/coder.min.ac37073bc2826cd28ef57364a9fe339de7ebcb26dafc22fd832cb35cf5b1d048.css" integrity="sha256-rDcHO8KCbNKO9XNkqf4znefryyba/CL9gyyzXPWx0Eg=" crossorigin="anonymous" media="screen" />
    

    

    

    

    <link rel="icon" type="image/png" href="http://vibhorkanojia.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://vibhorkanojia.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.53" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://vibhorkanojia.github.io">
      vibhor kanojia
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://vibhorkanojia.github.io/">Home</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://vibhorkanojia.github.io/posts/">Blogs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://vibhorkanojia.github.io/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Morris Traversal</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2019-01-19T00:36:50&#43;05:30'>
                January 19, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              3 minutes read
            </span>
          </div>
          
          
        </div>
      </header>
      <h3> Introduction </h3>
      <div>
        <p>As discussed before, there are various ways to traverse a binary tree. Inorder traversal is very popular as it visits nodes in a sorted manner if the tree is a binary search tree.</p>
<p>The common implementation of inorder traversal is by recursion. But recursive implementation is not considered to be O(1) space solution due to the recursion stack; it is in fact O(logN). Inorder traversal can also be implemented iteratively by using a stack data structure, but even this implementation will have O(N) space complexity. There exists an algorithm called Morris Traversal which guarantees iterative inorder traversal of a binary tree with O(1) space complexity.</p> 
<p> Note that this is a slightly advanced algorithm and should be considered only when the normal recursive implementation results in TLE.</p>

<h3> Tutorials </h3>

<table>
  <tr>
    <th>Links</th>
  </tr>
  <tr>
      <td><a href="https://en.wikipedia.org/wiki/Threaded_binary_tree">Wikipedia</a></td>
  </tr>
  <tr>
      <td><a href="https://www.geeksforgeeks.org/inorder-tree-traversal-without-recursion-and-without-stack/">GeeksforGeeks</a></td>
  </tr>
</table>

<h3> Complexity </h3>
<table>
  <tr>
    <th>Time Complexity (Worst case)</th>
    <th>Space Compexity (Worst case)</th>
  </tr>
  <tr>
    <td>O(N)</td>
    <td>O(1)</td>
  </tr>
</table>

<h3> Specifics </h3>
<p>Morris traveral works by creating a threaded binary tree where we create a link from one node to its inorder successor. We create links as we move towards the left child, and then remove them as we go towards the right child to restore the original tree.
<p>Morris traversal, by creating extra links, ensures that when we reach a node that doesn't have a right child, we don't have to traverse the tree upwards to know which node to print next.
<h3> Implementation </h3>

<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">struct</span> Node{
    <span style="color:#fff;font-weight:bold">int</span> value;
    Node * left;
    Node * right;
};

<span style="color:#007f7f">/*
</span><span style="color:#007f7f">      Example Tree:
</span><span style="color:#007f7f">               1
</span><span style="color:#007f7f">             /   \
</span><span style="color:#007f7f">           2      3
</span><span style="color:#007f7f">         /  \
</span><span style="color:#007f7f">       4     5
</span><span style="color:#007f7f">
</span><span style="color:#007f7f">
</span><span style="color:#007f7f">           |           
</span><span style="color:#007f7f">           V
</span><span style="color:#007f7f">
</span><span style="color:#007f7f">            1
</span><span style="color:#007f7f">          /   \ 
</span><span style="color:#007f7f">        2      3 
</span><span style="color:#007f7f">      /  \ 
</span><span style="color:#007f7f">    4     5 
</span><span style="color:#007f7f">     \     \
</span><span style="color:#007f7f">      2     1
</span><span style="color:#007f7f">
</span><span style="color:#007f7f">*/</span>

<span style="color:#fff;font-weight:bold">void</span> MorrisTraversal(Node * root){
    Node * current = root;
    Node * previous = <span style="color:#fff;font-weight:bold">NULL</span>;
    
    <span style="color:#fff;font-weight:bold">while</span>(current != <span style="color:#fff;font-weight:bold">NULL</span>){
        <span style="color:#007f7f">//Most basic condition: If left child doesn&#39;t exist, print current node and go to right child.
</span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span> (current-&gt;left == <span style="color:#fff;font-weight:bold">NULL</span>){
            cout &lt;&lt; current-&gt;value &lt;&lt;endl;
            current = current -&gt; right;
        }

        <span style="color:#fff;font-weight:bold">else</span>{
            <span style="color:#007f7f">//previous pointer is used to find the previous node in inorder traversal
</span><span style="color:#007f7f"></span>            previous = current-&gt;left;
            
            <span style="color:#fff;font-weight:bold">while</span> (previous-&gt;right !=<span style="color:#fff;font-weight:bold">NULL</span> &amp;&amp; previous-&gt;right != current){
                previous = previous-&gt;right;
            }
            
            
            <span style="color:#007f7f">// previous-&gt;right == NULL would mean that we found the previous node in inorder traversal
</span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// Hence, we will create a link from this previous node to current node, making current node its right child.
</span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// we then move the current pointer to its left, and start the loop again. Basically, before moving to the left,
</span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// we had to make sure that we had a way to reach the current node again. That we did by creating a link.
</span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (previous-&gt;right == <span style="color:#fff;font-weight:bold">NULL</span>){
                previous-&gt;right = current;
                current = current-&gt;left;
            }


            <span style="color:#007f7f">// previous-&gt;right == current would mean that we had already processed the subtree in the left, hence we need to clear
</span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// the link. As we have processed the left subtree completely, we just have to print the current node, and move to its right.
</span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">else</span>{
                previous-&gt;right = <span style="color:#fff;font-weight:bold">NULL</span>;
                cout&lt;&lt;current-&gt;value&lt;&lt;endl;
                current = current-&gt;right;
            }
        }
    }   
}
</code></pre></td></tr></table>
</div>
</div>
      </div>

      <footer>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "vkanojia" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
     © 2019
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
